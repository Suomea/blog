## 身份鉴别	
a）应对登录的用户进行身份标识和鉴别，身份标识具有唯一性，身份鉴别信息具有复杂度要求并定期更换；
b）应具有登录失败处理功能，应配置并启用结束会话、限制非法登录次数和当登录连接超时自动退出等相关措施；
c）当进行远程管理时，应采取必要措施防止鉴别信息在网络传输过程中被窃听；
d）应采用口令、密码技术、生物技术等两种或两种以上组合的鉴别技术对用户进行身份鉴别，且其中一种鉴别技术至少应使用密码技术来实现。

主要通过 PAM 来满足上述要求。

1. 密码强度
安装密码策略强化模块：
```
apt install libpam-pwquality
```

编辑配置文件
```
# /etc/pam.d/common-password
password requisite pam_pwquality.so retry=3 minlen=10 ucredit=-1 lcredit=-1 dcredit=-1 ocredit=-1
- retry=3 修改密码最多允许重试 3 次。
- minlen=10 最小长度。
- ucredit=1 至少一个大写字母。
- lcredit=1 至少一个小写字母。
- dcredit=1 至少包含一个数字。
- ocredit=1 至少包含一个特殊字符。
```


2. 密码有效期
```
# /etc/login.defs
PASS_MAX_DAYS 90 # 密码最长使用 90 天 
PASS_MIN_DAYS 7 # 密码最短 7 天内不能修改 
PASS_WARN_AGE 14 # 密码过期前 14 天开始提醒用户
```

修改配置文件支队新用户生效，现有用户需要手动更改。
```
chage -M 90 -m 7 -W 14 jacky
chage -l jacky
```

3. 登录失败锁定

安装模块
```
apt install libpam-faillock
```

配置
```
# 编辑配置文件进行配置 /etc/pam.d/common-auth
auth required pam_faillock.so preauth silent deny=5 unlock_time=600 
auth required pam_faillock.so authfail deny=5 unlock_time=600

# 查看所用用户
faillock

# 查看特定用户
faillock --user jacky

# 手动解锁
faillock --user jacky --reset
```

pam 是基于账号的锁定，可以进一步使用 fail2ban 进行网络层的封禁处理（基于 IP 地址）。

4. 会话超时自动退出
```
# 编辑配置文件 /etc/profile，配置 900 秒自动退出会话
export TMOUT=900
```

## 访问控制	
a）应对登录的用户分配账户和权限；
b）应重命名或删除默认账户，修改默认账户的默认口令；
c）应及时删除或停用多余的、过期的账户，避免共享账户的存在；
d）应授予管理用户所需的最小权限，实现管理用户的权限分离；
e）应由授权主体配置访问控制策略，访问控制策略规定主体对客体的访问规则；
f）访问控制的粒度应达到主体为用户级或进程级，客体为文件、数据库表级；
g）应对重要主体和客体设置安全标记，并控制主体对有安全标记信息资源的访问。
## 安全审计
a）应启用安全审计功能，审计覆盖到每个用户，对重要的用户行为和重要安全事件进行审计；
b）审计记录应包括事件的日期和时间、用户、事件类型、事件是否成功及其他与审计相关的信息；
c）应对审计记录进行保护，定期备份，避免受到未预期的删除、修改或覆盖等；
d）应对审计进程进行保护，防止未经授权的中断。
## 入侵防范	
a）应遵循最小安装的原则，仅安装需要的组件和应用程序；
b）应关闭不需要的系统服务、默认共享和高危端口；
c）应通过设定终端接入方式或网络地址范围对通过网络进行管理的管理终端进行限制；
d）应提供数据有效性检验功能，保证通过人机接口输入或通过通信接口输入的内容符合系统设定要求；
e）应能发现可能存在的已知漏洞，并在经过充分测试评估后，及时修补漏洞；
f）应能够检测到对重要节点进行入侵的行为，并在发生严重入侵事件时提供报警。

## 恶意代码防范	
a）应采用免受恶意代码攻击的技术措施或主动免疫可信验证机制及时识别入侵和病毒行为，并将其有效阻断。

## 可信验证	
a）可基于可信根对计算设备的系统引导程序、系统程序、重要配置参数和应用程序等进行可信验证，并在应用程序的关键执行环节进行动态可信验证，在检测到其可信性受到破坏后进行报警，并将验证结果形成审计记录送至安全管理中心。
## 数据完整性	
a）应采用校验技术或密码技术保证重要数据在传输过程中的完整性，包括但不限于鉴别数据、重要业务数据、重要审计数据、重要配置数据、重要视频数据和重要个人信息等；
b）应采用校验技术或密码技术保证重要数据在存储过程中的完整性，包括但不限于鉴别数据、重要业务数据、重要审计数据、重要配置数据、重要视频数据和重要个人信息等。
a）应采用密码技术保证重要数据在传输过程中的保密性，包括但不限于鉴别数据、重要业务数据和重要个人信息等；
b）应采用密码技术保证重要数据在存储过程中的保密性，包括但不限于鉴别数据、重要业务数据和重要个人信息等。

## 数据备份恢复	
a）应提供重要数据的本地数据备份与恢复功能；
b）应提供异地实时备份功能，利用通信网络将重要数据实时备份至备份场地；
c）应提供重要数据处理系统的热冗余，保证系统的高可用性。

## 剩余信息保护	
a）应保证鉴别信息所在的存储空间被释放或重新分配前得到完全清除；
b）应保证存有敏感数据的存储空间被释放或重新分配前得到完全清除。

## 个人信息保护	
a）应仅采集和保存业务必需的用户个人信息；
b）应禁止未授权访问和非法使用用户个人信息。
