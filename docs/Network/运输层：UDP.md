---
comments: true
tags:
  - Network
---
### 简介

用户数据报协议，User Datagram Protocol，提供进程到进程之间的通信。

UDP 没有流量控制，在分组收到时也没有确认。UDP 也没有差错控制，如果 UDP 检测到分组中有差错，它就丢掉这个分组。

UDP 是一种无连接、不可靠的运输协议。它除了在 IP 服务的基础上增加了进程到进程的通信，使之不再是主机到主机的通信之外，就再没有什么了。

UDP 功能很弱，但是为什么还有进程使用呢？因为简单，那么也就意味这开销小，因此适合一些对实时性要求高、容忍少量数据丢失的应用场景，比如音视频流传输、在线游戏等。

### 协议格式介绍

![](../LocalFile/Picture/用户数据报的格式.png)
**源端口号** 源主机上进程所使用的端口号。16 位长，取值范围为 0~65535。

**目的端口号** 运行在目的主机上的进程所使用的端口号。16 位长，取值范围为 0~65535。

**总长度** 16 位的字段，定义了用户数据包的总长度，首部加上数据。16 位可以定义的总长度为 0~65535，但是实际上 UDP 要放在总长度为 65535 字节的 IP 数据报之中，所以 UDP 数据报的最大总长度要小于 65535 字节。

**校验和** 

### UDP 使用的熟知端口

| 端口  | 协议      | 说明             |
| --- | ------- | -------------- |
| 7   | Echo    | 把接收到的数据报回送到发送方 |
| 9   | Discard | 丢弃收到的任何数据报     |
| 11  | Users   | 活跃的用户          |
| 13  | Daytime | 返回日期和时间        |
| 17  | Quote   | 返回日期的引用        |
| 19  | Chargen | 返回字符串          |
| 53  | Domain  | DNS            |
| 67  | Bootps  | 下载引导程序信息的服务器端口 |
| 68  | Bootpc  | 下载引导程序的客户端端口   |
| 69  | TFTP    | 简单的文件传送协议      |
| 111 | RPC     | 远程过程调用         |
| 123 | NTP     | 网络时间协议         |
| 161 | SNMP    | 简单的网络管理协议      |
| 162 | SNMP    | 简单的网络管理协议（陷阱）  |

## 无连接的服务

UDP 提供无连接的服务，这就意味着由 UDP 发送的每一个用户数据报都是独立的数据报，不同的用户数据报之前没有任何关系。

无连接导致的另一个结果就是：使用 UDP 的进程不能发送流数据到 UDP，也不能期望 UDP 把这个数据流分割成许多个互相关联的用户数据报。相反，进程的每一个请求都必须足够小，使其能够封装进一个用户数据报中。只有那些发送短的报文才应该使用 UDP。

## 流量控制

UDP 没有流量控制。

## 差错控制

除了校验和之外，UDP 没有提供其他差错控制机制。这就表示发送方并不知道报文是丢失了还是重复交付了。当接收方通过校验和检测出差错时，就直接丢掉这个用户数据报，缺少差错控制机制就意味着在必要时应当由使用 UDP 的进程来提供这种服务。

校验和的计算校验算法和 IP 协议类似。

UDP 校验和的计算包括三个部分：伪首部、UDP 首部以及应用层的数据。

UDP 分组的发送方可以选择不计算校验和。若不计算校验和，则在发送之前把校验和字段全部填入0。